

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rasterio.mask module &mdash; rasterio 1.0a12 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="rasterio 1.0a12 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> rasterio
          

          
          </a>

          
            
            
              <div class="version">
                1.0a12
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="switch.html">Switching from GDAL’s Python bindings</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="topics/color.html">Color</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/concurrency.html">Concurrent processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/errors.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/features.html">Vector Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/fillnodata.html">Filling nodata areas</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/georeferencing.html">Georeferencing</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/image_options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/image_processing.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/masking-by-shapefile.html">Masking a raster using a shapefile</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/masks.html">Nodata Masks</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/memory-files.html">In-Memory Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/migrating-to-v1.html">Migrating to Rasterio 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/overviews.html">Overviews</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/reproject.html">Reprojection</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/resampling.html">Resampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/tags.html">Tagging datasets and bands</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/virtual-warping.html">Virtual Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/virtual-warping.html#normalizing-data-to-a-consistent-grid">Normalizing Data to a Consistent Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/vsi.html">Virtual Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="topics/windowed-rw.html">Windowed reading and writing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">rasterio package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Users Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">rasterio</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>rasterio.mask module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rasterio.mask.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-rasterio.mask">
<span id="rasterio-mask-module"></span><h1>rasterio.mask module<a class="headerlink" href="#module-rasterio.mask" title="Permalink to this headline">¶</a></h1>
<p>Mask the area outside of the input shapes with no data.</p>
<dl class="function">
<dt id="rasterio.mask.mask">
<code class="descclassname">rasterio.mask.</code><code class="descname">mask</code><span class="sig-paren">(</span><em>dataset</em>, <em>shapes</em>, <em>all_touched=False</em>, <em>invert=False</em>, <em>nodata=None</em>, <em>filled=True</em>, <em>crop=False</em>, <em>pad=False</em>, <em>indexes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rasterio/mask.html#mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rasterio.mask.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a masked or filled array using input shapes.
Pixels are masked or set to nodata outside the input shapes, unless
<cite>invert</cite> is <cite>True</cite>.</p>
<p>If shapes do not overlap the raster and crop=True, a ValueError is
raised.  Otherwise, a warning is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataset: a dataset object opened in ‘r’ mode</strong></p>
<blockquote>
<div><p>Raster to which the mask will be applied.</p>
</div></blockquote>
<p><strong>shapes: list of polygons</strong></p>
<blockquote>
<div><p>GeoJSON-like dict representation of polygons that will be used to
create the mask.</p>
</div></blockquote>
<p><strong>all_touched: bool (opt)</strong></p>
<blockquote>
<div><p>Include a pixel in the mask if it touches any of the shapes.
If False (default), include a pixel only if its center is within one of
the shapes, or if it is selected by Bresenham’s line algorithm.</p>
</div></blockquote>
<p><strong>invert: bool (opt)</strong></p>
<blockquote>
<div><p>If False (default) pixels outside shapes will be masked.  If True,
pixels inside shape will be masked.</p>
</div></blockquote>
<p><strong>nodata: int or float (opt)</strong></p>
<blockquote>
<div><p>Value representing nodata within each raster band. If not set,
defaults to the nodata value for the input raster. If there is no
set nodata value for the raster, it defaults to 0.</p>
</div></blockquote>
<p><strong>filled: bool (opt)</strong></p>
<blockquote>
<div><p>If True, the pixels outside the features will be set to nodata.
If False, the output array will contain the original pixel data,
and only the mask will be based on shapes.  Defaults to True.</p>
</div></blockquote>
<p><strong>crop: bool (opt)</strong></p>
<blockquote>
<div><p>Whether to crop the raster to the extent of the shapes. Defaults to
False.</p>
</div></blockquote>
<p><strong>pad: bool (opt)</strong></p>
<blockquote>
<div><p>If True, the features will be padded in each direction by
one half of a pixel prior to cropping raster. Defaults to False.</p>
</div></blockquote>
<p><strong>indexes</strong> : list of ints or a single int (opt)</p>
<blockquote>
<div><p>If <cite>indexes</cite> is a list, the result is a 3D array, but is
a 2D array if it is a band index number.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuple</p>
<blockquote class="last">
<div><p>Two elements:</p>
<blockquote>
<div><dl class="docutils">
<dt>masked <span class="classifier-delimiter">:</span> <span class="classifier">numpy ndarray or numpy.ma.MaskedArray</span></dt>
<dd><p class="first">Data contained in the raster after applying the mask. If
<cite>filled</cite> is <cite>True</cite> and <cite>invert</cite> is <cite>False</cite>, the return will be
an array where pixels outside shapes are set to the nodata value
(or nodata inside shapes if <cite>invert</cite> is <cite>True</cite>).</p>
<p class="last">If <cite>filled</cite> is <cite>False</cite>, the return will be a MaskedArray in
which pixels outside shapes are <cite>True</cite> (or <cite>False</cite> if <cite>invert</cite>
is <cite>True</cite>).</p>
</dd>
<dt>out_transform <span class="classifier-delimiter">:</span> <span class="classifier">affine.Affine()</span></dt>
<dd><p class="first last">Information for mapping pixel coordinates in <cite>masked</cite> to another
coordinate system.</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rasterio.mask.raster_geometry_mask">
<code class="descclassname">rasterio.mask.</code><code class="descname">raster_geometry_mask</code><span class="sig-paren">(</span><em>dataset</em>, <em>shapes</em>, <em>all_touched=False</em>, <em>invert=False</em>, <em>crop=False</em>, <em>pad=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rasterio/mask.html#raster_geometry_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rasterio.mask.raster_geometry_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a mask from shapes, transform, and optional window within original
raster.</p>
<p>By default, mask is intended for use as a numpy mask, where pixels that
overlap shapes are False.</p>
<p>If shapes do not overlap the raster and crop=True, a ValueError is
raised.  Otherwise, a warning is raised, and a completely True mask
is returned (if invert is False).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataset: a dataset object opened in ‘r’ mode</strong></p>
<blockquote>
<div><p>Raster for which the mask will be created.</p>
</div></blockquote>
<p><strong>shapes: list of polygons</strong></p>
<blockquote>
<div><p>GeoJSON-like dict representation of polygons that will be used to
create the mask.</p>
</div></blockquote>
<p><strong>all_touched: bool (opt)</strong></p>
<blockquote>
<div><p>Include a pixel in the mask if it touches any of the shapes.
If False (default), include a pixel only if its center is within one of
the shapes, or if it is selected by Bresenham’s line algorithm.</p>
</div></blockquote>
<p><strong>invert: bool (opt)</strong></p>
<blockquote>
<div><p>If False (default), mask will be <cite>False</cite> inside shapes and <cite>True</cite>
outside.  If True, mask will be <cite>True</cite> inside shapes and <cite>False</cite>
outside.</p>
</div></blockquote>
<p><strong>crop: bool (opt)</strong></p>
<blockquote>
<div><p>Whether to crop the dataset to the extent of the shapes. Defaults to
False.</p>
</div></blockquote>
<p><strong>pad: bool (opt)</strong></p>
<blockquote>
<div><p>If True, the features will be padded in each direction by
one half of a pixel prior to cropping dataset. Defaults to False.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuple</p>
<blockquote class="last">
<div><p>Three elements:</p>
<blockquote>
<div><dl class="docutils">
<dt>mask <span class="classifier-delimiter">:</span> <span class="classifier">numpy ndarray of type ‘bool’</span></dt>
<dd><p class="first last">Mask that is <cite>True</cite> outside shapes, and <cite>False</cite> within shapes.</p>
</dd>
<dt>out_transform <span class="classifier-delimiter">:</span> <span class="classifier">affine.Affine()</span></dt>
<dd><p class="first last">Information for mapping pixel coordinates in <cite>masked</cite> to another
coordinate system.</p>
</dd>
<dt>window: rasterio.windows.Window instance</dt>
<dd><p class="first last">Window within original raster covered by shapes.  None if crop
is False.</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Mapbox.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0a12',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>